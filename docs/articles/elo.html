<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The 'elo' Package • elo</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="The 'elo' Package">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">elo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.1.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/elo.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/eheinzen/elo">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="elo_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>The ‘elo’ Package</h1>
                        <h4 class="author">Ethan Heinzen</h4>
            
            <h4 class="date">2020-10-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/eheinzen/elo/blob/master/vignettes/elo.Rmd"><code>vignettes/elo.Rmd</code></a></small>
      <div class="hidden name"><code>elo.Rmd</code></div>

    </div>

    
    
<div id="the-elo-package" class="section level1">
<h1 class="hasAnchor">
<a href="#the-elo-package" class="anchor"></a>The <code>elo</code> Package</h1>
<p>The <code>elo</code> package includes functions to address all kinds of Elo calculations.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(elo)</span></code></pre></div>
<div id="naming-schema" class="section level2">
<h2 class="hasAnchor">
<a href="#naming-schema" class="anchor"></a>Naming Schema</h2>
<p>Most functions begin with the prefix “elo.”, for easy autocompletion.</p>
<ul>
<li><p>Vectors or scalars of Elo scores are denoted <code>elo.A</code> or <code>elo.B</code>.</p></li>
<li><p>Vectors or scalars of wins by team A are denoted by <code>wins.A</code>.</p></li>
<li><p>Vectors or scalars of win probabilities are denoted by <code>p.A</code>.</p></li>
<li><p>Vectors of team names are denoted <code>team.A</code> or <code>team.B</code>.</p></li>
</ul>
</div>
</div>
<div id="basic-functions" class="section level1">
<h1 class="hasAnchor">
<a href="#basic-functions" class="anchor"></a>Basic Functions</h1>
<p>To calculate the probability team.A beats team.B, use <code><a href="../reference/elo.prob.html">elo.prob()</a></code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>elo.A &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1500</span>, <span class="dv">1500</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a>elo.B &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1500</span>, <span class="dv">1600</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="kw"><a href="../reference/elo.prob.html">elo.prob</a></span>(elo.A, elo.B)</span></code></pre></div>
<pre><code>## [1] 0.500000 0.359935</code></pre>
<p>To calculate the score update after the two teams play, use <code><a href="../reference/elo.update.html">elo.update()</a></code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>wins.A &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="kw"><a href="../reference/elo.update.html">elo.update</a></span>(wins.A, elo.A, elo.B, <span class="dt">k =</span> <span class="dv">20</span>)</span></code></pre></div>
<pre><code>## [1] 10.0000 -7.1987</code></pre>
<p>To calculate the new Elo scores after the update, use <code><a href="../reference/elo.calc.html">elo.calc()</a></code>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw"><a href="../reference/elo.calc.html">elo.calc</a></span>(wins.A, elo.A, elo.B, <span class="dt">k =</span> <span class="dv">20</span>)</span></code></pre></div>
<pre><code>##      elo.A    elo.B
## 1 1510.000 1490.000
## 2 1492.801 1607.199</code></pre>
</div>
<div id="the-elo-run-function" class="section level1">
<h1 class="hasAnchor">
<a href="#the-elo-run-function" class="anchor"></a>The <code>elo.run()</code> function</h1>
<div id="with-two-variable-elos" class="section level2">
<h2 class="hasAnchor">
<a href="#with-two-variable-elos" class="anchor"></a>With two variable Elos</h2>
<p>To calculate a series of Elo updates, use <code><a href="../reference/elo.run.html">elo.run()</a></code>. This function has a <code>formula =</code> and <code>data =</code> interface. We first load the dataset <code>tournament</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(tournament)</span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(tournament)</span></code></pre></div>
<pre><code>## 'data.frame':    56 obs. of  6 variables:
##  $ team.Home     : chr  "Blundering Baboons" "Defense-less Dogs" "Fabulous Frogs" "Helpless Hyenas" ...
##  $ team.Visitor  : chr  "Athletic Armadillos" "Cunning Cats" "Elegant Emus" "Gallivanting Gorillas" ...
##  $ points.Home   : num  14 21 15 13 22 18 20 23 25 23 ...
##  $ points.Visitor: num  22 18 11 15 13 20 22 10 16 18 ...
##  $ week          : num  1 1 1 1 2 2 2 2 3 3 ...
##  $ half          : chr  "First Half of Season" "First Half of Season" "First Half of Season" "First Half of Season" ...</code></pre>
<p><code>formula =</code> should be in the format of <code>wins.A ~ team.A + team.B</code>. The <code><a href="../reference/score.html">score()</a></code> function will help to calculate winners on the fly (1 = win, 0.5 = tie, 0 = loss).</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>tournament<span class="op">$</span>wins.A &lt;-<span class="st"> </span>tournament<span class="op">$</span>points.Home <span class="op">&gt;</span><span class="st"> </span>tournament<span class="op">$</span>points.Visitor</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="kw"><a href="../reference/elo.run.html">elo.run</a></span>(wins.A <span class="op">~</span><span class="st"> </span>team.Home <span class="op">+</span><span class="st"> </span>team.Visitor, <span class="dt">data =</span> tournament, <span class="dt">k =</span> <span class="dv">20</span>)</span></code></pre></div>
<pre><code>## 
## An object of class 'elo.run', containing information on 8 teams and 56 matches.</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw"><a href="../reference/elo.run.html">elo.run</a></span>(<span class="kw"><a href="../reference/score.html">score</a></span>(points.Home, points.Visitor) <span class="op">~</span><span class="st"> </span>team.Home <span class="op">+</span><span class="st"> </span>team.Visitor, <span class="dt">data =</span> tournament, <span class="dt">k =</span> <span class="dv">20</span>)</span></code></pre></div>
<pre><code>## 
## An object of class 'elo.run', containing information on 8 teams and 56 matches.</code></pre>
<p>For more complicated Elo updates, you can include the special function <code><a href="../reference/formula.specials.html">k()</a></code> in the <code>formula =</code> argument. Here we’re taking the log of the win margin as part of our update.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw"><a href="../reference/elo.run.html">elo.run</a></span>(<span class="kw"><a href="../reference/score.html">score</a></span>(points.Home, points.Visitor) <span class="op">~</span><span class="st"> </span>team.Home <span class="op">+</span><span class="st"> </span>team.Visitor <span class="op">+</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="st">        </span><span class="kw"><a href="../reference/formula.specials.html">k</a></span>(<span class="dv">20</span><span class="op">*</span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(points.Home <span class="op">-</span><span class="st"> </span>points.Visitor) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)), <span class="dt">data =</span> tournament)</span></code></pre></div>
<pre><code>## 
## An object of class 'elo.run', containing information on 8 teams and 56 matches.</code></pre>
<p>You can also adjust the home and visitor teams with different k’s:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>k1 &lt;-<span class="st"> </span><span class="dv">20</span><span class="op">*</span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(tournament<span class="op">$</span>points.Home <span class="op">-</span><span class="st"> </span>tournament<span class="op">$</span>points.Visitor) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="kw"><a href="../reference/elo.run.html">elo.run</a></span>(<span class="kw"><a href="../reference/score.html">score</a></span>(points.Home, points.Visitor) <span class="op">~</span><span class="st"> </span>team.Home <span class="op">+</span><span class="st"> </span>team.Visitor <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/formula.specials.html">k</a></span>(k1, k1<span class="op">/</span><span class="dv">2</span>), <span class="dt">data =</span> tournament)</span></code></pre></div>
<pre><code>## 
## An object of class 'elo.run', containing information on 8 teams and 56 matches.</code></pre>
<p>It’s also possible to adjust one team’s Elo for a variety of factors (e.g., home-field advantage). The <code><a href="../reference/formula.specials.html">adjust()</a></code> special function will take as its second argument a vector or a constant.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw"><a href="../reference/elo.run.html">elo.run</a></span>(<span class="kw"><a href="../reference/score.html">score</a></span>(points.Home, points.Visitor) <span class="op">~</span><span class="st"> </span><span class="kw"><a href="../reference/formula.specials.html">adjust</a></span>(team.Home, <span class="dv">10</span>) <span class="op">+</span><span class="st"> </span>team.Visitor,</span>
<span id="cb18-2"><a href="#cb18-2"></a>        <span class="dt">data =</span> tournament, <span class="dt">k =</span> <span class="dv">20</span>)</span></code></pre></div>
<pre><code>## 
## An object of class 'elo.run', containing information on 8 teams and 56 matches.</code></pre>
</div>
<div id="with-a-fixed-elo-opponent" class="section level2">
<h2 class="hasAnchor">
<a href="#with-a-fixed-elo-opponent" class="anchor"></a>With a fixed-Elo opponent</h2>
<p><code><a href="../reference/elo.run.html">elo.run()</a></code> also recognizes if the second column is numeric, and interprets that as a fixed-Elo opponent.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>tournament<span class="op">$</span>elo.Visitor &lt;-<span class="st"> </span><span class="dv">1500</span></span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="kw"><a href="../reference/elo.run.html">elo.run</a></span>(<span class="kw"><a href="../reference/score.html">score</a></span>(points.Home, points.Visitor) <span class="op">~</span><span class="st"> </span>team.Home <span class="op">+</span><span class="st"> </span>elo.Visitor,</span>
<span id="cb20-3"><a href="#cb20-3"></a>        <span class="dt">data =</span> tournament, <span class="dt">k =</span> <span class="dv">20</span>)</span></code></pre></div>
<pre><code>## 
## An object of class 'elo.run', containing information on 8 teams and 56 matches.</code></pre>
</div>
<div id="regress-elos-back-to-the-mean" class="section level2">
<h2 class="hasAnchor">
<a href="#regress-elos-back-to-the-mean" class="anchor"></a>Regress Elos back to the mean</h2>
<p>The special function <code><a href="../reference/formula.specials.html">regress()</a></code> can be used to regress Elos back to a fixed value after certain matches. Giving a logical vector identifies these matches after which to regress back to the mean. Giving any other kind of vector regresses after the appropriate groupings (see, e.g., <code><a href="https://rdrr.io/r/base/duplicated.html">duplicated(..., fromLast = TRUE)</a></code>). The other three arguments determine what Elo to regress to (<code>to =</code>, which could be a different value for different teams), by how much to regress toward that value (<code>by =</code>), and whether to regress teams which aren’t actively playing (<code>regress.unused =</code>).</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>tournament<span class="op">$</span>elo.Visitor &lt;-<span class="st"> </span><span class="dv">1500</span></span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="kw"><a href="../reference/elo.run.html">elo.run</a></span>(<span class="kw"><a href="../reference/score.html">score</a></span>(points.Home, points.Visitor) <span class="op">~</span><span class="st"> </span>team.Home <span class="op">+</span><span class="st"> </span>elo.Visitor <span class="op">+</span></span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="st">        </span><span class="kw"><a href="../reference/formula.specials.html">regress</a></span>(half, <span class="dv">1500</span>, <span class="fl">0.2</span>),</span>
<span id="cb22-4"><a href="#cb22-4"></a>        <span class="dt">data =</span> tournament, <span class="dt">k =</span> <span class="dv">20</span>)</span></code></pre></div>
<pre><code>## 
## An object of class 'elo.run.regressed', containing information on 8 teams and 56 matches, with 2 regressions.</code></pre>
</div>
<div id="group-matches" class="section level2">
<h2 class="hasAnchor">
<a href="#group-matches" class="anchor"></a>Group matches</h2>
<p>The special function <code><a href="../reference/formula.specials.html">group()</a></code> tells <code><a href="../reference/elo.run.html">elo.run()</a></code> when to update Elos. It also determines matches to group together in <code><a href="https://rdrr.io/r/base/matrix.html">as.matrix()</a></code>.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>er &lt;-<span class="st"> </span><span class="kw"><a href="../reference/elo.run.html">elo.run</a></span>(<span class="kw"><a href="../reference/score.html">score</a></span>(points.Home, points.Visitor) <span class="op">~</span><span class="st"> </span>team.Home <span class="op">+</span><span class="st"> </span>team.Visitor <span class="op">+</span></span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="st">                </span><span class="kw"><a href="../reference/formula.specials.html">group</a></span>(week),</span>
<span id="cb24-3"><a href="#cb24-3"></a>              <span class="dt">data =</span> tournament, <span class="dt">k =</span> <span class="dv">20</span>)</span>
<span id="cb24-4"><a href="#cb24-4"></a><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(er)</span></code></pre></div>
<pre><code>##       Athletic Armadillos Blundering Baboons Cunning Cats Defense-less Dogs
##  [1,]            1510.000           1490.000     1490.000          1510.000
##  [2,]            1499.425           1500.575     1500.575          1499.425
##  [3,]            1489.425           1490.575     1510.575          1509.425
##  [4,]            1499.458           1480.542     1520.542          1499.458
##  [5,]            1489.458           1470.542     1520.542          1489.458
##  [6,]            1490.033           1461.971     1509.681          1480.033
##  [7,]            1501.153           1453.313     1499.945          1470.647
##  [8,]            1509.785           1444.682     1509.104          1461.489
##  [9,]            1519.765           1455.165     1499.124          1451.005
## [10,]            1527.812           1446.423     1507.865          1442.959
## [11,]            1537.372           1458.979     1508.123          1434.819
## [12,]            1547.007           1450.239     1518.364          1437.130
## [13,]            1556.067           1461.837     1528.173          1429.335
## [14,]            1564.318           1453.079     1518.019          1421.394
##       Elegant Emus Fabulous Frogs Gallivanting Gorillas Helpless Hyenas
##  [1,]     1490.000       1510.000              1510.000        1490.000
##  [2,]     1500.575       1499.425              1499.425        1500.575
##  [3,]     1490.575       1489.425              1509.425        1510.575
##  [4,]     1480.542       1499.458              1499.458        1520.542
##  [5,]     1490.542       1509.458              1509.458        1520.542
##  [6,]     1501.403       1518.883              1508.883        1529.113
##  [7,]     1510.789       1528.618              1517.541        1517.993
##  [8,]     1501.302       1538.106              1527.554        1507.980
##  [9,]     1502.056       1527.241              1526.800        1518.844
## [10,]     1512.539       1537.228              1516.813        1508.362
## [11,]     1502.978       1524.672              1516.555        1516.501
## [12,]     1511.718       1515.038              1514.245        1506.260
## [13,]     1501.910       1522.832              1505.185        1494.661
## [14,]     1509.851       1532.986              1513.944        1486.411</code></pre>
<p>This can be useful in situations when using the Elo framework for games which aren’t explicitly head-to-head (e.g., golf, swimming). For those situations, the person who won can be considered as having beaten (head-to-head) every other person. The person who came in second “beat” everyone but the first. However, we wouldn’t want to update Elos after every “head-to-head”; rather, they should all be considered together in updating Elo.</p>
<p>An example might help clarify. Suppose participants 1-3 go head-to-head in a game, with participant 2 coming in first, participant 1 coming in second, and participant 3 coming in last. Then we might have a dataset like</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>d</span></code></pre></div>
<pre><code>##    team1  team2 won
## 1 Part 2 Part 1   1
## 2 Part 2 Part 3   1
## 3 Part 1 Part 3   1</code></pre>
<p>We would want to consider all three of these matches at the same time, so we add a grouping variable and run <code><a href="../reference/elo.run.html">elo.run()</a></code>:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>d<span class="op">$</span>group &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="kw"><a href="../reference/elo.run.helpers.html">final.elos</a></span>(<span class="kw"><a href="../reference/elo.run.html">elo.run</a></span>(won <span class="op">~</span><span class="st"> </span>team1 <span class="op">+</span><span class="st"> </span>team2 <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/formula.specials.html">group</a></span>(group), <span class="dt">data =</span> d, <span class="dt">k =</span> <span class="dv">20</span>))</span></code></pre></div>
<pre><code>## Part 1 Part 2 Part 3 
##   1500   1520   1480</code></pre>
</div>
<div id="helper-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#helper-functions" class="anchor"></a>Helper functions</h2>
<p>There are several helper functions that are useful to use when interacting with objects of class <code>"elo.run"</code>.</p>
<p><code><a href="../reference/summary.elo.html">summary.elo.run()</a></code> reports some summary statistics.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>e &lt;-<span class="st"> </span><span class="kw"><a href="../reference/elo.run.html">elo.run</a></span>(<span class="kw"><a href="../reference/score.html">score</a></span>(points.Home, points.Visitor) <span class="op">~</span><span class="st"> </span>team.Home <span class="op">+</span><span class="st"> </span>team.Visitor,</span>
<span id="cb30-2"><a href="#cb30-2"></a>             <span class="dt">data =</span> tournament, <span class="dt">k =</span> <span class="dv">20</span>)</span>
<span id="cb30-3"><a href="#cb30-3"></a><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(e)</span></code></pre></div>
<pre><code>## 
## An object of class 'elo.run', containing information on 8 teams and 56 matches.
## 
## Mean Square Error: 0.2195
## AUC: 0.6304
## Favored Teams vs. Actual Wins: 
##        Actual
## Favored  0 0.5  1
##   TRUE   6   1 16
##   (tie)  2   1  9
##   FALSE  8   3 10</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="kw"><a href="../reference/rank.teams.html">rank.teams</a></span>(e)</span></code></pre></div>
<pre><code>##   Athletic Armadillos    Blundering Baboons          Cunning Cats 
##                     1                     7                     3 
##     Defense-less Dogs          Elegant Emus        Fabulous Frogs 
##                     8                     5                     2 
## Gallivanting Gorillas       Helpless Hyenas 
##                     4                     6</code></pre>
<p><code><a href="../reference/elo.run.helpers.html">as.matrix.elo.run()</a></code> creates a matrix of running Elos.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(e))</span></code></pre></div>
<pre><code>##      Athletic Armadillos Blundering Baboons Cunning Cats Defense-less Dogs
## [1,]            1510.000           1490.000     1500.000          1500.000
## [2,]            1510.000           1490.000     1490.000          1510.000
## [3,]            1510.000           1490.000     1490.000          1510.000
## [4,]            1510.000           1490.000     1490.000          1510.000
## [5,]            1499.425           1490.000     1500.575          1510.000
## [6,]            1499.425           1500.575     1500.575          1499.425
##      Elegant Emus Fabulous Frogs Gallivanting Gorillas Helpless Hyenas
## [1,]         1500           1500                  1500            1500
## [2,]         1500           1500                  1500            1500
## [3,]         1490           1510                  1500            1500
## [4,]         1490           1510                  1510            1490
## [5,]         1490           1510                  1510            1490
## [6,]         1490           1510                  1510            1490</code></pre>
<p><code><a href="../reference/elo.run.helpers.html">as.data.frame.elo.run()</a></code> gives the long version (perfect, for, e.g., <code>ggplot2</code>).</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(e))</span></code></pre></div>
<pre><code>## 'data.frame':    56 obs. of  8 variables:
##  $ team.A  : Factor w/ 8 levels "Athletic Armadillos",..: 2 4 6 8 3 4 7 8 4 3 ...
##  $ team.B  : Factor w/ 8 levels "Athletic Armadillos",..: 1 3 5 7 1 2 5 6 1 2 ...
##  $ p.A     : num  0.5 0.5 0.5 0.5 0.471 ...
##  $ wins.A  : num  0 1 1 0 1 0 0 1 1 1 ...
##  $ update.A: num  -10 10 10 -10 10.6 ...
##  $ update.B: num  10 -10 -10 10 -10.6 ...
##  $ elo.A   : num  1490 1510 1510 1490 1501 ...
##  $ elo.B   : num  1510 1490 1490 1510 1499 ...</code></pre>
<p>Finally, <code><a href="../reference/elo.run.helpers.html">final.elos()</a></code> will extract the final Elos per team.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="kw"><a href="../reference/elo.run.helpers.html">final.elos</a></span>(e)</span></code></pre></div>
<pre><code>##   Athletic Armadillos    Blundering Baboons          Cunning Cats 
##              1564.318              1453.079              1518.019 
##     Defense-less Dogs          Elegant Emus        Fabulous Frogs 
##              1421.394              1509.851              1532.986 
## Gallivanting Gorillas       Helpless Hyenas 
##              1513.944              1486.411</code></pre>
</div>
<div id="making-predictions" class="section level2">
<h2 class="hasAnchor">
<a href="#making-predictions" class="anchor"></a>Making Predictions</h2>
<p>It is also possible to use the Elos calculated by <code><a href="../reference/elo.run.html">elo.run()</a></code> to make predictions on future match-ups.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>results &lt;-<span class="st"> </span><span class="kw"><a href="../reference/elo.run.html">elo.run</a></span>(<span class="kw"><a href="../reference/score.html">score</a></span>(points.Home, points.Visitor) <span class="op">~</span><span class="st"> </span><span class="kw"><a href="../reference/formula.specials.html">adjust</a></span>(team.Home, <span class="dv">10</span>) <span class="op">+</span><span class="st"> </span>team.Visitor,</span>
<span id="cb40-2"><a href="#cb40-2"></a>                   <span class="dt">data =</span> tournament, <span class="dt">k =</span> <span class="dv">20</span>)</span>
<span id="cb40-3"><a href="#cb40-3"></a>newdat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(</span>
<span id="cb40-4"><a href="#cb40-4"></a>  <span class="dt">team.Home =</span> <span class="st">"Athletic Armadillos"</span>,</span>
<span id="cb40-5"><a href="#cb40-5"></a>  <span class="dt">team.Visitor =</span> <span class="st">"Blundering Baboons"</span></span>
<span id="cb40-6"><a href="#cb40-6"></a>)</span>
<span id="cb40-7"><a href="#cb40-7"></a><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(results, <span class="dt">newdata =</span> newdat)</span></code></pre></div>
<pre><code>## [1] 0.6676045</code></pre>
</div>
<div id="advanced-custom-probability-and-updates" class="section level2">
<h2 class="hasAnchor">
<a href="#advanced-custom-probability-and-updates" class="anchor"></a>Advanced: custom probability and updates</h2>
<p>We now get to <code><a href="../reference/elo.run.html">elo.run()</a></code> when custom probability calculations and Elo updates are needed. Note that these use cases are coded in R instead of C++ and may run as much as 50x slower than the default.</p>
<p>For instance, suppose you want to change the adjustment based on team A’s current Elo:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>custom_update &lt;-<span class="st"> </span><span class="cf">function</span>(wins.A, elo.A, elo.B, k, adjust.A, adjust.B, ...)</span>
<span id="cb42-2"><a href="#cb42-2"></a>{</span>
<span id="cb42-3"><a href="#cb42-3"></a>  k<span class="op">*</span>(wins.A <span class="op">-</span><span class="st"> </span><span class="kw"><a href="../reference/elo.prob.html">elo.prob</a></span>(elo.A, elo.B, <span class="dt">adjust.B =</span> adjust.B,</span>
<span id="cb42-4"><a href="#cb42-4"></a>                       <span class="dt">adjust.A =</span> <span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(elo.A <span class="op">&gt;</span><span class="st"> </span><span class="dv">1500</span>, adjust.A <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, adjust.A)))</span>
<span id="cb42-5"><a href="#cb42-5"></a>}</span>
<span id="cb42-6"><a href="#cb42-6"></a>custom_prob &lt;-<span class="st"> </span><span class="cf">function</span>(elo.A, elo.B, adjust.A, adjust.B)</span>
<span id="cb42-7"><a href="#cb42-7"></a>{</span>
<span id="cb42-8"><a href="#cb42-8"></a>  <span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">10</span><span class="op">^</span>(((elo.B <span class="op">+</span><span class="st"> </span>adjust.B) <span class="op">-</span><span class="st"> </span>(elo.A <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(elo.A <span class="op">&gt;</span><span class="st"> </span><span class="dv">1500</span>, adjust.A <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, adjust.A)))<span class="op">/</span><span class="fl">400.0</span>))</span>
<span id="cb42-9"><a href="#cb42-9"></a>}</span>
<span id="cb42-10"><a href="#cb42-10"></a>er2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/elo.run.html">elo.run</a></span>(<span class="kw"><a href="../reference/score.html">score</a></span>(points.Home, points.Visitor) <span class="op">~</span><span class="st"> </span><span class="kw"><a href="../reference/formula.specials.html">adjust</a></span>(team.Home, <span class="dv">10</span>) <span class="op">+</span><span class="st"> </span>team.Visitor,</span>
<span id="cb42-11"><a href="#cb42-11"></a>               <span class="dt">data =</span> tournament, <span class="dt">k =</span> <span class="dv">20</span>, <span class="dt">prob.fun =</span> custom_prob, <span class="dt">update.fun =</span> custom_update)</span></code></pre></div>
<pre><code>## Using R instead of C++</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="kw"><a href="../reference/elo.run.helpers.html">final.elos</a></span>(er2)</span></code></pre></div>
<pre><code>##   Athletic Armadillos    Blundering Baboons          Cunning Cats 
##              1564.660              1452.278              1518.165 
##     Defense-less Dogs          Elegant Emus        Fabulous Frogs 
##              1420.876              1510.015              1533.209 
## Gallivanting Gorillas       Helpless Hyenas 
##              1514.233              1486.564</code></pre>
<p>Compare this to the results from the default:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>er3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/elo.run.html">elo.run</a></span>(<span class="kw"><a href="../reference/score.html">score</a></span>(points.Home, points.Visitor) <span class="op">~</span><span class="st"> </span><span class="kw"><a href="../reference/formula.specials.html">adjust</a></span>(team.Home, <span class="dv">10</span>) <span class="op">+</span><span class="st"> </span>team.Visitor,</span>
<span id="cb46-2"><a href="#cb46-2"></a>               <span class="dt">data =</span> tournament, <span class="dt">k =</span> <span class="dv">20</span>)</span>
<span id="cb46-3"><a href="#cb46-3"></a><span class="kw"><a href="../reference/elo.run.helpers.html">final.elos</a></span>(er3)</span></code></pre></div>
<pre><code>##   Athletic Armadillos    Blundering Baboons          Cunning Cats 
##              1563.967              1452.822              1517.847 
##     Defense-less Dogs          Elegant Emus        Fabulous Frogs 
##              1421.358              1509.906              1533.127 
## Gallivanting Gorillas       Helpless Hyenas 
##              1514.205              1486.768</code></pre>
<p>This example is a bit contrived, as it’d be easier just to use <code><a href="../reference/formula.specials.html">adjust()</a></code> (actually, this is tested for in the tests), but the point remains.</p>
</div>
</div>
<div id="basic-functions-revisited---formula-interface" class="section level1">
<h1 class="hasAnchor">
<a href="#basic-functions-revisited---formula-interface" class="anchor"></a>Basic Functions Revisited - Formula Interface</h1>
<p>All three of the “basic” functions accept formulas as input, just like <code><a href="../reference/elo.run.html">elo.run()</a></code>.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>dat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">elo.A =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1500</span>, <span class="dv">1500</span>), <span class="dt">elo.B =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1500</span>, <span class="dv">1600</span>),</span>
<span id="cb48-2"><a href="#cb48-2"></a>                  <span class="dt">wins.A =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="dt">k =</span> <span class="dv">20</span>)</span>
<span id="cb48-3"><a href="#cb48-3"></a>form &lt;-<span class="st"> </span>wins.A <span class="op">~</span><span class="st"> </span>elo.A <span class="op">+</span><span class="st"> </span>elo.B <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/formula.specials.html">k</a></span>(k)</span>
<span id="cb48-4"><a href="#cb48-4"></a><span class="kw"><a href="../reference/elo.prob.html">elo.prob</a></span>(form, <span class="dt">data =</span> dat)</span></code></pre></div>
<pre><code>## [1] 0.500000 0.359935</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="kw"><a href="../reference/elo.update.html">elo.update</a></span>(form, <span class="dt">data =</span> dat)</span></code></pre></div>
<pre><code>## [1] 10.0000 -7.1987</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="kw"><a href="../reference/elo.calc.html">elo.calc</a></span>(form, <span class="dt">data =</span> dat)</span></code></pre></div>
<pre><code>##      elo.A    elo.B
## 1 1510.000 1490.000
## 2 1492.801 1607.199</code></pre>
<p>Note that for <code><a href="../reference/elo.prob.html">elo.prob()</a></code>, <code>formula =</code> can be more succinct:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="kw"><a href="../reference/elo.prob.html">elo.prob</a></span>(<span class="op">~</span><span class="st"> </span>elo.A <span class="op">+</span><span class="st"> </span>elo.B, <span class="dt">data =</span> dat)</span></code></pre></div>
<pre><code>## [1] 0.500000 0.359935</code></pre>
<p>We can even adjust the Elos:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="kw"><a href="../reference/elo.calc.html">elo.calc</a></span>(wins.A <span class="op">~</span><span class="st"> </span><span class="kw"><a href="../reference/formula.specials.html">adjust</a></span>(elo.A, <span class="dv">10</span>) <span class="op">+</span><span class="st"> </span>elo.B <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/formula.specials.html">k</a></span>(k), <span class="dt">data =</span> dat)</span></code></pre></div>
<pre><code>##      elo.A    elo.B
## 1 1509.712 1490.288
## 2 1492.534 1607.466</code></pre>
</div>
<div id="comparison-models" class="section level1">
<h1 class="hasAnchor">
<a href="#comparison-models" class="anchor"></a>Comparison Models</h1>
<div id="winloss-logistic-regression" class="section level2">
<h2 class="hasAnchor">
<a href="#winloss-logistic-regression" class="anchor"></a>Win/Loss Logistic Regression</h2>
<p>The first model computes teams’ win percentages, and feeds the differences of percentages into a regression. Including an adjustment using <code><a href="../reference/formula.specials.html">adjust()</a></code> in the formula also includes that in the model. You could also adjust the intercept for games played on neutral fields by using the <code><a href="../reference/formula.specials.html">neutral()</a></code> function.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>e.winpct &lt;-<span class="st"> </span><span class="kw"><a href="../reference/elo.winpct.html">elo.winpct</a></span>(<span class="kw"><a href="../reference/score.html">score</a></span>(points.Home, points.Visitor) <span class="op">~</span><span class="st"> </span>team.Home <span class="op">+</span><span class="st"> </span>team.Visitor <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/formula.specials.html">group</a></span>(week), <span class="dt">data =</span> tournament,</span>
<span id="cb58-2"><a href="#cb58-2"></a>                       <span class="dt">subset =</span> points.Home <span class="op">!=</span><span class="st"> </span>points.Visitor) <span class="co"># to get rid of ties for now</span></span>
<span id="cb58-3"><a href="#cb58-3"></a><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(e.winpct)</span></code></pre></div>
<pre><code>## 
## An object of class 'elo.winpct', containing information on 8 teams and 51 matches.
## 
## Mean Square Error: 0.1566
## AUC: 0.8339
## Favored Teams vs. Actual Wins: 
##        Actual
## Favored  0  1
##   TRUE   7 32
##   (tie)  0  0
##   FALSE  9  3</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="kw"><a href="../reference/rank.teams.html">rank.teams</a></span>(e.winpct)</span></code></pre></div>
<pre><code>##   Athletic Armadillos    Blundering Baboons          Cunning Cats 
##                     1                     7                     4 
##     Defense-less Dogs          Elegant Emus        Fabulous Frogs 
##                     8                     5                     2 
## Gallivanting Gorillas       Helpless Hyenas 
##                     3                     6</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(e.winpct, <span class="dt">newdata =</span> <span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">team.Home =</span> <span class="st">"Athletic Armadillos"</span>, <span class="dt">team.Visitor =</span> <span class="st">"Blundering Baboons"</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>))</span></code></pre></div>
<pre><code>##         1 
## 0.9690678</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a>tournament<span class="op">$</span>neutral &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/replace.html">replace</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="dv">0</span>, <span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(tournament)), <span class="dv">30</span><span class="op">:</span><span class="dv">35</span>, <span class="dv">1</span>)</span>
<span id="cb64-2"><a href="#cb64-2"></a><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw"><a href="../reference/elo.winpct.html">elo.winpct</a></span>(<span class="kw"><a href="../reference/score.html">score</a></span>(points.Home, points.Visitor) <span class="op">~</span><span class="st"> </span>team.Home <span class="op">+</span><span class="st"> </span>team.Visitor <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/formula.specials.html">neutral</a></span>(neutral) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/formula.specials.html">group</a></span>(week),</span>
<span id="cb64-3"><a href="#cb64-3"></a>                   <span class="dt">data =</span> tournament, <span class="dt">subset =</span> points.Home <span class="op">!=</span><span class="st"> </span>points.Visitor))</span></code></pre></div>
<pre><code>## 
## An object of class 'elo.winpct', containing information on 8 teams and 51 matches.
## 
## Mean Square Error: 0.1565
## AUC: 0.825
## Favored Teams vs. Actual Wins: 
##        Actual
## Favored  0  1
##   TRUE   6 32
##   (tie)  0  0
##   FALSE 10  3</code></pre>
<p>The models can be built “running”, where predictions for the next group of games are made based on past data. Consider using the <code>skip=</code> argument to skip the first few groups (otherwise the model might have trouble converging).</p>
<p>Note that predictions from this object use a model fit on all the data.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a>e.winpct &lt;-<span class="st"> </span><span class="kw"><a href="../reference/elo.winpct.html">elo.winpct</a></span>(<span class="kw"><a href="../reference/score.html">score</a></span>(points.Home, points.Visitor) <span class="op">~</span><span class="st"> </span>team.Home <span class="op">+</span><span class="st"> </span>team.Visitor <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/formula.specials.html">group</a></span>(week), <span class="dt">data =</span> tournament,</span>
<span id="cb66-2"><a href="#cb66-2"></a>                       <span class="dt">subset =</span> points.Home <span class="op">!=</span><span class="st"> </span>points.Visitor, <span class="dt">running =</span> <span class="ot">TRUE</span>, <span class="dt">skip =</span> <span class="dv">5</span>)</span>
<span id="cb66-3"><a href="#cb66-3"></a><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(e.winpct)</span></code></pre></div>
<pre><code>## 
## An object of class 'elo.winpct', containing information on 8 teams and 51 matches.
## 
## Mean Square Error: 0.1769
## AUC: 0.8339
## Favored Teams vs. Actual Wins: 
##        Actual
## Favored  0  1
##   TRUE   5 21
##   (tie)  6 13
##   FALSE  5  1</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(e.winpct, <span class="dt">newdata =</span> <span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">team.Home =</span> <span class="st">"Athletic Armadillos"</span>, <span class="dt">team.Visitor =</span> <span class="st">"Blundering Baboons"</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)) <span class="co"># the same thing</span></span></code></pre></div>
<pre><code>##         1 
## 0.9690678</code></pre>
</div>
<div id="logistic-regression" class="section level2">
<h2 class="hasAnchor">
<a href="#logistic-regression" class="anchor"></a>Logistic Regression</h2>
<p>It’s also possible to compare teams’ skills using logistic regression. A matrix of dummy variables is constructed, one for each team, where a value of 1 indicates a home team and -1 indicates a visiting team. The intercept then indicates a home-field advantage. To denote games played in a neutral setting (that is, without home-field advantage), use the <code><a href="../reference/formula.specials.html">neutral()</a></code> function. In short, the intercept will then be set to <code>1 - neutral()</code>. Including an adjustment using <code><a href="../reference/formula.specials.html">adjust()</a></code> in the formula also includes that in the model.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a>results &lt;-<span class="st"> </span><span class="kw"><a href="../reference/elo.glm.html">elo.glm</a></span>(<span class="kw"><a href="../reference/score.html">score</a></span>(points.Home, points.Visitor) <span class="op">~</span><span class="st"> </span>team.Home <span class="op">+</span><span class="st"> </span>team.Visitor <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/formula.specials.html">group</a></span>(week), <span class="dt">data =</span> tournament,</span>
<span id="cb70-2"><a href="#cb70-2"></a>                   <span class="dt">subset =</span> points.Home <span class="op">!=</span><span class="st"> </span>points.Visitor) <span class="co"># to get rid of ties for now</span></span>
<span id="cb70-3"><a href="#cb70-3"></a><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(results)</span></code></pre></div>
<pre><code>## 
## Call:
## stats::glm(formula = wins.A ~ . - 1, family = family, data = dat, 
##     weights = wts, subset = NULL, na.action = stats::na.pass)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.0108  -0.8255   0.4050   0.6560   2.1217  
## 
## Coefficients:
##                         Estimate Std. Error z value Pr(&gt;|z|)   
## home.field                1.0307     0.3871   2.663  0.00775 **
## `Athletic Armadillos`     1.4289     0.9546   1.497  0.13442   
## `Blundering Baboons`     -0.9637     0.9043  -1.066  0.28659   
## `Cunning Cats`            0.5377     0.9483   0.567  0.57074   
## `Defense-less Dogs`      -1.7413     1.0356  -1.681  0.09268 . 
## `Elegant Emus`            0.3931     0.8818   0.446  0.65576   
## `Fabulous Frogs`          0.8489     0.8807   0.964  0.33509   
## `Gallivanting Gorillas`   0.3994     0.9500   0.420  0.67417   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 70.701  on 51  degrees of freedom
## Residual deviance: 48.037  on 43  degrees of freedom
## AIC: 64.037
## 
## Number of Fisher Scoring iterations: 5
## 
## Mean Square Error: 0.1566
## AUC: 0.8375
## Favored Teams vs. Actual Wins: 
##        Actual
## Favored  0  1
##   TRUE   7 32
##   (tie)  0  0
##   FALSE  9  3</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a><span class="kw"><a href="../reference/rank.teams.html">rank.teams</a></span>(results)</span></code></pre></div>
<pre><code>##   Athletic Armadillos    Blundering Baboons          Cunning Cats 
##                     1                     7                     3 
##     Defense-less Dogs          Elegant Emus        Fabulous Frogs 
##                     8                     5                     2 
## Gallivanting Gorillas       Helpless Hyenas 
##                     4                     6</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(results, <span class="dt">newdata =</span> <span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">team.Home =</span> <span class="st">"Athletic Armadillos"</span>, <span class="dt">team.Visitor =</span> <span class="st">"Blundering Baboons"</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>))</span></code></pre></div>
<pre><code>##         1 
## 0.9684256</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw"><a href="../reference/elo.glm.html">elo.glm</a></span>(<span class="kw"><a href="../reference/score.html">score</a></span>(points.Home, points.Visitor) <span class="op">~</span><span class="st"> </span>team.Home <span class="op">+</span><span class="st"> </span>team.Visitor <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/formula.specials.html">neutral</a></span>(neutral) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/formula.specials.html">group</a></span>(week),</span>
<span id="cb76-2"><a href="#cb76-2"></a>                <span class="dt">data =</span> tournament, <span class="dt">subset =</span> points.Home <span class="op">!=</span><span class="st"> </span>points.Visitor))</span></code></pre></div>
<pre><code>## 
## Call:
## stats::glm(formula = wins.A ~ . - 1, family = family, data = dat, 
##     weights = wts, subset = NULL, na.action = stats::na.pass)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.0349  -0.7789   0.3933   0.7618   2.2148  
## 
## Coefficients:
##                         Estimate Std. Error z value Pr(&gt;|z|)  
## home.field                1.0886     0.4229   2.574   0.0101 *
## `Athletic Armadillos`     1.6006     0.9750   1.642   0.1007  
## `Blundering Baboons`     -0.8541     0.8930  -0.956   0.3389  
## `Cunning Cats`            0.5801     0.9446   0.614   0.5391  
## `Defense-less Dogs`      -1.8507     1.0449  -1.771   0.0765 .
## `Elegant Emus`            0.5762     0.8994   0.641   0.5218  
## `Fabulous Frogs`          0.8470     0.8804   0.962   0.3360  
## `Gallivanting Gorillas`   0.5777     0.9279   0.623   0.5335  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 70.701  on 51  degrees of freedom
## Residual deviance: 48.405  on 43  degrees of freedom
## AIC: 64.405
## 
## Number of Fisher Scoring iterations: 5
## 
## Mean Square Error: 0.1556
## AUC: 0.8375
## Favored Teams vs. Actual Wins: 
##        Actual
## Favored  0  1
##   TRUE   7 32
##   (tie)  0  0
##   FALSE  9  3</code></pre>
<p>The models can be built “running”, where predictions for the next group of games are made based on past data. Consider using the <code>skip=</code> argument to skip the first few groups (otherwise the model might have trouble converging).</p>
<p>Note that predictions from this object use a model fit on all the data.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a>results &lt;-<span class="st"> </span><span class="kw"><a href="../reference/elo.glm.html">elo.glm</a></span>(<span class="kw"><a href="../reference/score.html">score</a></span>(points.Home, points.Visitor) <span class="op">~</span><span class="st"> </span>team.Home <span class="op">+</span><span class="st"> </span>team.Visitor <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/formula.specials.html">group</a></span>(week), <span class="dt">data =</span> tournament,</span>
<span id="cb78-2"><a href="#cb78-2"></a>                   <span class="dt">subset =</span> points.Home <span class="op">!=</span><span class="st"> </span>points.Visitor, <span class="dt">running =</span> <span class="ot">TRUE</span>, <span class="dt">skip =</span> <span class="dv">5</span>)</span>
<span id="cb78-3"><a href="#cb78-3"></a><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(results)</span></code></pre></div>
<pre><code>## 
## Call:
## stats::glm(formula = wins.A ~ . - 1, family = family, data = dat, 
##     weights = wts, subset = NULL, na.action = stats::na.pass)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.0108  -0.8255   0.4050   0.6560   2.1217  
## 
## Coefficients:
##                         Estimate Std. Error z value Pr(&gt;|z|)   
## home.field                1.0307     0.3871   2.663  0.00775 **
## `Athletic Armadillos`     1.4289     0.9546   1.497  0.13442   
## `Blundering Baboons`     -0.9637     0.9043  -1.066  0.28659   
## `Cunning Cats`            0.5377     0.9483   0.567  0.57074   
## `Defense-less Dogs`      -1.7413     1.0356  -1.681  0.09268 . 
## `Elegant Emus`            0.3931     0.8818   0.446  0.65576   
## `Fabulous Frogs`          0.8489     0.8807   0.964  0.33509   
## `Gallivanting Gorillas`   0.3994     0.9500   0.420  0.67417   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 70.701  on 51  degrees of freedom
## Residual deviance: 48.037  on 43  degrees of freedom
## AIC: 64.037
## 
## Number of Fisher Scoring iterations: 5
## 
## Mean Square Error: 0.2098
## AUC: 0.8375
## Favored Teams vs. Actual Wins: 
##        Actual
## Favored  0  1
##   TRUE   6 19
##   (tie)  6 13
##   FALSE  4  3</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(results, <span class="dt">newdata =</span> <span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">team.Home =</span> <span class="st">"Athletic Armadillos"</span>, <span class="dt">team.Visitor =</span> <span class="st">"Blundering Baboons"</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)) <span class="co"># the same thing</span></span></code></pre></div>
<pre><code>##         1 
## 0.9684256</code></pre>
</div>
<div id="markov-chain" class="section level2">
<h2 class="hasAnchor">
<a href="#markov-chain" class="anchor"></a>Markov Chain</h2>
<p>It’s also possible to compare teams’ skills using a Markov-chain-based model, as outlined in <a href="https://scholarship.richmond.edu/cgi/viewcontent.cgi?article=1207&amp;context=mathcs-faculty-publications">Kvam and Sokol (2006)</a>. In short, imagine a judge who randomly picks one of two teams in a matchup, where the winner gets chosen with probability p (here, for convenience, ‘k’) and the loser with probability 1-p (1-k). In other words, we assume that the probability that the winning team is better than the losing team given that it won is k, and the probability that the losing team is better than the winning team given that it lost is (1-k). This forms a transition matrix, whose stationary distribution gives a ranking of teams. The differences in ranking are then fed into a logistic regession model to predict win status. Any adjustments made using <code><a href="../reference/formula.specials.html">adjust()</a></code> are also included in this logistic regression. You could also adjust the intercept for games played on neutral fields by using the <code><a href="../reference/formula.specials.html">neutral()</a></code> function.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a>mc &lt;-<span class="st"> </span><span class="kw"><a href="../reference/elo.markovchain.html">elo.markovchain</a></span>(<span class="kw"><a href="../reference/score.html">score</a></span>(points.Home, points.Visitor) <span class="op">~</span><span class="st"> </span>team.Home <span class="op">+</span><span class="st"> </span>team.Visitor, <span class="dt">data =</span> tournament,</span>
<span id="cb82-2"><a href="#cb82-2"></a>                      <span class="dt">subset =</span> points.Home <span class="op">!=</span><span class="st"> </span>points.Visitor, <span class="dt">k =</span> <span class="fl">0.7</span>)</span>
<span id="cb82-3"><a href="#cb82-3"></a><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(mc)</span></code></pre></div>
<pre><code>## 
## An object of class 'elo.markovchain', containing information on 8 teams and 51 matches.
## 
## Mean Square Error: 0.1688
## AUC: 0.8
## Favored Teams vs. Actual Wins: 
##        Actual
## Favored  0  1
##   TRUE  10 29
##   (tie)  0  0
##   FALSE  6  6</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a><span class="kw"><a href="../reference/rank.teams.html">rank.teams</a></span>(mc)</span></code></pre></div>
<pre><code>##   Athletic Armadillos    Blundering Baboons          Cunning Cats 
##                     1                     7                     3 
##     Defense-less Dogs          Elegant Emus        Fabulous Frogs 
##                     8                     4                     2 
## Gallivanting Gorillas       Helpless Hyenas 
##                     6                     5</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(mc, <span class="dt">newdata =</span> <span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">team.Home =</span> <span class="st">"Athletic Armadillos"</span>, <span class="dt">team.Visitor =</span> <span class="st">"Blundering Baboons"</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>))</span></code></pre></div>
<pre><code>##         1 
## 0.9594476</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw"><a href="../reference/elo.markovchain.html">elo.markovchain</a></span>(<span class="kw"><a href="../reference/score.html">score</a></span>(points.Home, points.Visitor) <span class="op">~</span><span class="st"> </span>team.Home <span class="op">+</span><span class="st"> </span>team.Visitor <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/formula.specials.html">neutral</a></span>(neutral),</span>
<span id="cb88-2"><a href="#cb88-2"></a>                        <span class="dt">data =</span> tournament, <span class="dt">subset =</span> points.Home <span class="op">!=</span><span class="st"> </span>points.Visitor, <span class="dt">k =</span> <span class="fl">0.7</span>))</span></code></pre></div>
<pre><code>## 
## An object of class 'elo.markovchain', containing information on 8 teams and 51 matches.
## 
## Mean Square Error: 0.1732
## AUC: 0.7857
## Favored Teams vs. Actual Wins: 
##        Actual
## Favored  0  1
##   TRUE  10 28
##   (tie)  0  0
##   FALSE  6  7</code></pre>
<p>These models can also be built “running”, where predictions for the next group of games are made based on past data. Consider using the <code>skip=</code> argument to skip the first few groups (otherwise the model might have trouble converging).</p>
<p>Note that predictions from this object use a model fit on all the data.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a>mc &lt;-<span class="st"> </span><span class="kw"><a href="../reference/elo.markovchain.html">elo.markovchain</a></span>(<span class="kw"><a href="../reference/score.html">score</a></span>(points.Home, points.Visitor) <span class="op">~</span><span class="st"> </span>team.Home <span class="op">+</span><span class="st"> </span>team.Visitor <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/formula.specials.html">group</a></span>(week), <span class="dt">data =</span> tournament,</span>
<span id="cb90-2"><a href="#cb90-2"></a>                      <span class="dt">subset =</span> points.Home <span class="op">!=</span><span class="st"> </span>points.Visitor, <span class="dt">k =</span> <span class="fl">0.7</span>, <span class="dt">running =</span> <span class="ot">TRUE</span>, <span class="dt">skip =</span> <span class="dv">5</span>)</span>
<span id="cb90-3"><a href="#cb90-3"></a><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(mc)</span></code></pre></div>
<pre><code>## 
## An object of class 'elo.markovchain', containing information on 8 teams and 51 matches.
## 
## Mean Square Error: 0.229
## AUC: 0.8
## Favored Teams vs. Actual Wins: 
##        Actual
## Favored  0  1
##   TRUE   6 19
##   (tie)  6 13
##   FALSE  4  3</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(mc, <span class="dt">newdata =</span> <span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">team.Home =</span> <span class="st">"Athletic Armadillos"</span>, <span class="dt">team.Visitor =</span> <span class="st">"Blundering Baboons"</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)) <span class="co"># the same thing</span></span></code></pre></div>
<pre><code>##         1 
## 0.9594476</code></pre>
<div id="a-note-about-lrmc" class="section level3">
<h3 class="hasAnchor">
<a href="#a-note-about-lrmc" class="anchor"></a>A note about LRMC</h3>
<p>Note that by assigning probabilities in the right way, this function emits the Logistic Regression Markov Chain model (LRMC). Use the in-formula function <code><a href="../reference/formula.specials.html">k()</a></code> for this. IMPORTANT: note that <code><a href="../reference/formula.specials.html">k()</a></code> denotes the probability assigned to the <em>winning</em> team, not the <em>home</em> team (for instance). If <code>rH(x)</code> denotes the probability that the home team is better given that they scored <code>x</code> points more than the visiting team (allowing for x to be negative), then an LRMC model might look something like this:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a><span class="kw"><a href="../reference/elo.markovchain.html">elo.markovchain</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Round.html">floor</a></span>(wins.home) <span class="op">~</span><span class="st"> </span>team.home <span class="op">+</span><span class="st"> </span>team.visitor <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/formula.specials.html">k</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, <span class="kw">rH</span>(x), <span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">rH</span>(x))))</span></code></pre></div>
<p>Why do we use <code><a href="https://rdrr.io/r/base/Round.html">floor()</a></code> here? This takes care of the odd case where teams tie. In this case, <code>rH(x) &lt; 0.5</code> because we expected the home team to win by virtue of being home. By default, <code><a href="../reference/elo.markovchain.html">elo.markovchain()</a></code> will split any ties down the middle (i.e., 0.5 and 0.5 instead of p and 1-p), which isn’t what we want; we want the visiting team to get a larger share than the home team. Telling <code><a href="../reference/elo.markovchain.html">elo.markovchain()</a></code> that the visiting team “won” gives the visiting team its whole share of <code>p</code>.</p>
<p>Alternatively, if <code>h</code> denotes a home-field advantage (in terms of score), the model becomes:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a><span class="kw"><a href="../reference/elo.markovchain.html">elo.markovchain</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(home.points <span class="op">-</span><span class="st"> </span>visitor.points <span class="op">&gt;</span><span class="st"> </span>h, <span class="dv">1</span>, <span class="dv">0</span>) <span class="op">~</span><span class="st"> </span>team.home <span class="op">+</span><span class="st"> </span>team.visitor <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/formula.specials.html">k</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">pmax</a></span>(<span class="kw">rH</span>(x), <span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">rH</span>(x))))</span></code></pre></div>
<p>In this case, the home team “won” if it scored more than <code>h</code> points more than the visiting team. Since <code>rH(x) &gt; 0.5</code> if <code>x &gt; h</code>, then <code><a href="https://rdrr.io/r/base/Extremes.html">pmax()</a></code> will assign the proper probability to the pseudo-winning team.</p>
<p>Finally, do note that using <code><a href="../reference/formula.specials.html">neutral()</a></code> isn’t sufficient for adjusting for games played on neutral ground, because the adjustment is only taken into account in the logistic regression to produce probabilities, not the building of the transition matrix. Therefore, you’ll want to also account for neutral wins/losses in <code><a href="../reference/formula.specials.html">k()</a></code> as well.</p>
</div>
</div>
<div id="colley-matrix-method" class="section level2">
<h2 class="hasAnchor">
<a href="#colley-matrix-method" class="anchor"></a>Colley Matrix Method</h2>
<p>It’s also possible to compare teams’ skills using the Colley Matrix method, as outlined in <a href="http://www.colleyrankings.com/matrate.pdf">Colley (2002)</a>. The coefficients to the Colley matrix formulation gives a ranking of teams. The differences in ranking are then fed into a logistic regession model to predict win status. Here ‘k’ denotes how convincing a win is; it represents the fraction of the win assigned to the winning team and the fraction of the loss assigned to the losing team. Setting ‘k’ = 1 emits the bias-free method presented by Colley. Any adjustments made using <code><a href="../reference/formula.specials.html">adjust()</a></code> are also included in this logistic regression. You could also adjust the intercept for games played on neutral fields by using the <code><a href="../reference/formula.specials.html">neutral()</a></code> function.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a>co &lt;-<span class="st"> </span><span class="kw"><a href="../reference/elo.colley.html">elo.colley</a></span>(<span class="kw"><a href="../reference/score.html">score</a></span>(points.Home, points.Visitor) <span class="op">~</span><span class="st"> </span>team.Home <span class="op">+</span><span class="st"> </span>team.Visitor, <span class="dt">data =</span> tournament,</span>
<span id="cb96-2"><a href="#cb96-2"></a>                 <span class="dt">subset =</span> points.Home <span class="op">!=</span><span class="st"> </span>points.Visitor)</span>
<span id="cb96-3"><a href="#cb96-3"></a><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(co)</span></code></pre></div>
<pre><code>## 
## An object of class 'elo.colley', containing information on 8 teams and 51 matches.
## 
## Mean Square Error: 0.1565
## AUC: 0.8339
## Favored Teams vs. Actual Wins: 
##        Actual
## Favored  0  1
##   TRUE   7 32
##   (tie)  0  0
##   FALSE  9  3</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a><span class="kw"><a href="../reference/rank.teams.html">rank.teams</a></span>(co)</span></code></pre></div>
<pre><code>##   Athletic Armadillos    Blundering Baboons          Cunning Cats 
##                     1                     7                     4 
##     Defense-less Dogs          Elegant Emus        Fabulous Frogs 
##                     8                     5                     2 
## Gallivanting Gorillas       Helpless Hyenas 
##                     3                     6</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(co, <span class="dt">newdata =</span> <span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">team.Home =</span> <span class="st">"Athletic Armadillos"</span>, <span class="dt">team.Visitor =</span> <span class="st">"Blundering Baboons"</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>))</span></code></pre></div>
<pre><code>##         1 
## 0.9687583</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw"><a href="../reference/elo.colley.html">elo.colley</a></span>(<span class="kw"><a href="../reference/score.html">score</a></span>(points.Home, points.Visitor) <span class="op">~</span><span class="st"> </span>team.Home <span class="op">+</span><span class="st"> </span>team.Visitor <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/formula.specials.html">neutral</a></span>(neutral),</span>
<span id="cb102-2"><a href="#cb102-2"></a>                   <span class="dt">data =</span> tournament, <span class="dt">subset =</span> points.Home <span class="op">!=</span><span class="st"> </span>points.Visitor))</span></code></pre></div>
<pre><code>## 
## An object of class 'elo.colley', containing information on 8 teams and 51 matches.
## 
## Mean Square Error: 0.1565
## AUC: 0.8268
## Favored Teams vs. Actual Wins: 
##        Actual
## Favored  0  1
##   TRUE   6 32
##   (tie)  0  0
##   FALSE 10  3</code></pre>
<p>These models can also be built “running”, where predictions for the next group of games are made based on past data. Consider using the <code>skip=</code> argument to skip the first few groups (otherwise the model might have trouble converging).</p>
<p>Note that predictions from this object use a model fit on all the data.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a>co &lt;-<span class="st"> </span><span class="kw"><a href="../reference/elo.colley.html">elo.colley</a></span>(<span class="kw"><a href="../reference/score.html">score</a></span>(points.Home, points.Visitor) <span class="op">~</span><span class="st"> </span>team.Home <span class="op">+</span><span class="st"> </span>team.Visitor <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/formula.specials.html">group</a></span>(week), <span class="dt">data =</span> tournament,</span>
<span id="cb104-2"><a href="#cb104-2"></a>                      <span class="dt">subset =</span> points.Home <span class="op">!=</span><span class="st"> </span>points.Visitor, <span class="dt">running =</span> <span class="ot">TRUE</span>, <span class="dt">skip =</span> <span class="dv">5</span>)</span>
<span id="cb104-3"><a href="#cb104-3"></a><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(co)</span></code></pre></div>
<pre><code>## 
## An object of class 'elo.colley', containing information on 8 teams and 51 matches.
## 
## Mean Square Error: 0.2173
## AUC: 0.8339
## Favored Teams vs. Actual Wins: 
##        Actual
## Favored  0  1
##   TRUE   4 19
##   (tie)  6 13
##   FALSE  6  3</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1"></a><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(co, <span class="dt">newdata =</span> <span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">team.Home =</span> <span class="st">"Athletic Armadillos"</span>, <span class="dt">team.Visitor =</span> <span class="st">"Blundering Baboons"</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)) <span class="co"># the same thing</span></span></code></pre></div>
<pre><code>##         1 
## 0.9687583</code></pre>
</div>
</div>
<div id="modeling-margin-of-victory-instead-of-wins" class="section level1">
<h1 class="hasAnchor">
<a href="#modeling-margin-of-victory-instead-of-wins" class="anchor"></a>Modeling Margin of Victory Instead of Wins</h1>
<p><code><a href="../reference/elo.glm.html">elo.glm()</a></code>, <code><a href="../reference/elo.markovchain.html">elo.markovchain()</a></code>, and <code><a href="../reference/elo.winpct.html">elo.winpct()</a></code> all allow for modeling of margins of victory instead of simple win/loss using the <code><a href="../reference/elo.mov.html">mov()</a></code> function. Note that one must set the <code>family="gaussian"</code> argument to get linear regression instead of logistic regression.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1"></a><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw"><a href="../reference/elo.glm.html">elo.glm</a></span>(<span class="kw"><a href="../reference/elo.mov.html">mov</a></span>(points.Home, points.Visitor) <span class="op">~</span><span class="st"> </span>team.Home <span class="op">+</span><span class="st"> </span>team.Visitor, <span class="dt">data =</span> tournament,</span>
<span id="cb108-2"><a href="#cb108-2"></a>                <span class="dt">family =</span> <span class="st">"gaussian"</span>))</span></code></pre></div>
<pre><code>## 
## Call:
## stats::glm(formula = wins.A ~ . - 1, family = family, data = dat, 
##     weights = wts, subset = NULL, na.action = stats::na.pass)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -10.6339   -2.8996   -0.0402    2.7879   12.9286  
## 
## Coefficients:
##                         Estimate Std. Error t value Pr(&gt;|t|)    
## home.field                2.6964     0.6941   3.885 0.000313 ***
## `Athletic Armadillos`     3.1250     1.8363   1.702 0.095263 .  
## `Blundering Baboons`     -2.4375     1.8363  -1.327 0.190655    
## `Cunning Cats`            0.3125     1.8363   0.170 0.865584    
## `Defense-less Dogs`      -3.5000     1.8363  -1.906 0.062646 .  
## `Elegant Emus`           -0.9375     1.8363  -0.511 0.612014    
## `Fabulous Frogs`          0.6875     1.8363   0.374 0.709759    
## `Gallivanting Gorillas`   0.2500     1.8363   0.136 0.892277    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for gaussian family taken to be 26.97582)
## 
##     Null deviance: 2161.0  on 56  degrees of freedom
## Residual deviance: 1294.8  on 48  degrees of freedom
## AIC: 352.81
## 
## Number of Fisher Scoring iterations: 2
## 
## Mean Square Error: 23.1221
## AUC: NA
## Favored Teams vs. Actual Wins: 
##        Actual
## Favored TRUE (tie) FALSE
##   TRUE    31     3    10
##   (tie)    0     0     0
##   FALSE    4     2     6</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#the-elo-package">The <code>elo</code> Package</a><ul class="nav nav-pills nav-stacked">
<li><a href="#naming-schema">Naming Schema</a></li>
      </ul>
</li>
      <li><a href="#basic-functions">Basic Functions</a></li>
      <li>
<a href="#the-elo-run-function">The <code>elo.run()</code> function</a><ul class="nav nav-pills nav-stacked">
<li><a href="#with-two-variable-elos">With two variable Elos</a></li>
      <li><a href="#with-a-fixed-elo-opponent">With a fixed-Elo opponent</a></li>
      <li><a href="#regress-elos-back-to-the-mean">Regress Elos back to the mean</a></li>
      <li><a href="#group-matches">Group matches</a></li>
      <li><a href="#helper-functions">Helper functions</a></li>
      <li><a href="#making-predictions">Making Predictions</a></li>
      <li><a href="#advanced-custom-probability-and-updates">Advanced: custom probability and updates</a></li>
      </ul>
</li>
      <li><a href="#basic-functions-revisited---formula-interface">Basic Functions Revisited - Formula Interface</a></li>
      <li>
<a href="#comparison-models">Comparison Models</a><ul class="nav nav-pills nav-stacked">
<li><a href="#winloss-logistic-regression">Win/Loss Logistic Regression</a></li>
      <li><a href="#logistic-regression">Logistic Regression</a></li>
      <li><a href="#markov-chain">Markov Chain</a></li>
      <li><a href="#colley-matrix-method">Colley Matrix Method</a></li>
      </ul>
</li>
      <li><a href="#modeling-margin-of-victory-instead-of-wins">Modeling Margin of Victory Instead of Wins</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Ethan Heinzen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
